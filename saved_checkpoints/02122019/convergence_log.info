Epoch 2/20
8400/8400 [==============================] - 4544s 541ms/step - loss: 0.4803 - binary_accuracy: 0.7708 - val_loss: 0.3754 - val_binary_accuracy: 0.8426
Epoch 3/20
8400/8400 [==============================] - 4789s 570ms/step - loss: 0.3385 - binary_accuracy: 0.8612 - val_loss: 0.2650 - val_binary_accuracy: 0.8955
Epoch 4/20
8400/8400 [==============================] - 4750s 566ms/step - loss: 0.2199 - binary_accuracy: 0.9140 - val_loss: 0.2917 - val_binary_accuracy: 0.8745
Epoch 5/20
8400/8400 [==============================] - 4807s 572ms/step - loss: 0.1716 - binary_accuracy: 0.9364 - val_loss: 0.1846 - val_binary_accuracy: 0.9174
Epoch 6/20
8400/8400 [==============================] - 4506s 536ms/step - loss: 0.1504 - binary_accuracy: 0.9435 - val_loss: 0.1206 - val_binary_accuracy: 0.9555
Epoch 7/20
8400/8400 [==============================] - 4636s 552ms/step - loss: 0.1407 - binary_accuracy: 0.9500 - val_loss: 0.1511 - val_binary_accuracy: 0.9357
Epoch 8/20
8400/8400 [==============================] - 4595s 547ms/step - loss: 0.1100 - binary_accuracy: 0.9613 - val_loss: 0.0944 - val_binary_accuracy: 0.9695
Epoch 9/20
8400/8400 [==============================] - 4579s 545ms/step - loss: 0.0742 - binary_accuracy: 0.9742 - val_loss: 0.0777 - val_binary_accuracy: 0.9729
Epoch 10/20
8400/8400 [==============================] - 4577s 545ms/step - loss: 0.0595 - binary_accuracy: 0.9782 - val_loss: 0.0817 - val_binary_accuracy: 0.9700
Epoch 11/20
8400/8400 [==============================] - 4582s 545ms/step - loss: 0.0399 - binary_accuracy: 0.9855 - val_loss: 0.0699 - val_binary_accuracy: 0.9769
Epoch 12/20
8400/8400 [==============================] - 4607s 548ms/step - loss: 0.0534 - binary_accuracy: 0.9793 - val_loss: 0.0780 - val_binary_accuracy: 0.9764
Epoch 13/20
8400/8400 [==============================] - 4687s 558ms/step - loss: 0.0287 - binary_accuracy: 0.9902 - val_loss: 0.0856 - val_binary_accuracy: 0.9779
Epoch 14/20
8400/8400 [==============================] - 4495s 535ms/step - loss: 0.0409 - binary_accuracy: 0.9854 - val_loss: 0.1346 - val_binary_accuracy: 0.9588
Epoch 15/20
8400/8400 [==============================] - 4432s 528ms/step - loss: 0.0253 - binary_accuracy: 0.9915 - val_loss: 0.0696 - val_binary_accuracy: 0.9800
Epoch 16/20
8400/8400 [==============================] - 4444s 529ms/step - loss: 0.0234 - binary_accuracy: 0.9911 - val_loss: 0.0732 - val_binary_accuracy: 0.9802
Epoch 17/20
8400/8400 [==============================] - 4407s 525ms/step - loss: 0.0300 - binary_accuracy: 0.9900 - val_loss: 0.0691 - val_binary_accuracy: 0.9762
Epoch 18/20
8400/8400 [==============================] - 4453s 530ms/step - loss: 0.0202 - binary_accuracy: 0.9924 - val_loss: 0.1052 - val_binary_accuracy: 0.9588
Epoch 19/20
8400/8400 [==============================] - 4505s 536ms/step - loss: 0.1801 - binary_accuracy: 0.9329 - val_loss: 0.1398 - val_binary_accuracy: 0.9493
Epoch 20/20
8400/8400 [==============================] - 4363s 519ms/step - loss: 0.0837 - binary_accuracy: 0.9705 - val_loss: 0.0868 - val_binary_accuracy: 0.9712
losses: 
[0.6152786059606643, 0.4803237226747331, 0.3384936672732944, 0.21990882135572887, 0.17160745998223623, 0.15042142596273195, 0.14067236656234378, 0.11004763601081712, 0.0741834773336138, 0.05954736818515119, 0.039859839957650925, 0.053418830499230394, 0.028714037175689426, 0.040911693696287416, 0.025325236505263353, 0.02339278510926912, 0.030012474890709632, 0.020210754028964967, 0.18014469820562573, 0.08368786701134273]
accuracies: 
[0.7178571427436102, 0.842619047846113, 0.8954761902491252, 0.8745238094102769, 0.917380952494485, 0.9554761907032557, 0.9357142858278183, 0.9695238096373422, 0.9728571430842081, 0.97, 0.9769047621318272, 0.9764285716556368, 0.9778571430842081, 0.9588095239230565, 0.9800000002270653, 0.9802380951245626, 0.9761904760769435, 0.9588095236959912, 0.9492857145127795, 0.9711904764175415]
Time for training is 91213.529742 sec
Starting predictions:
Accuracy: 96.14% 
 Time: 194.80179691314697s 
 Time/example : 0.13914414065224784s/ex
1400/1400 [==============================] - 194s 139ms/step
'Binary' accuracy ((TP+TN)/total) sample number is:
0.9614285714285714
'Binary' confusion ((FP+FN)/total) sample number is:
0.03857142857142857
False Positive sample number is:
54.0
Precision is:
0.9614285714285714
Recall is:
0.9614285714285714
F1 score is:
0.9614285714285714
Starting to compute ROC metrics...
Initial Accuracy: 96.14% 
 Time: 189.16318273544312s 
 Time/example : 0.13511655909674508s/ex
1400/1400 [==============================] - 190s 136ms/step
The fixed categories are:
['friend', 'foe']
DEBUG::True positive rate w.r.t p_threshold array:
[[0.99357143 0.99357143]
 [0.99142857 0.99142857]
 [0.98714286 0.98714286]
 [0.98642857 0.98642857]
 [0.98142857 0.98142857]
 [0.97785714 0.97785714]
 [0.97571429 0.97571429]
 [0.97285714 0.97285714]
 [0.96571429 0.96571429]
 [0.96214286 0.96214286]
 [0.96071429 0.96071429]
 [0.95714286 0.95714286]
 [0.955      0.955     ]
 [0.95071429 0.95071429]
 [0.94642857 0.94642857]
 [0.935      0.935     ]
 [0.92428571 0.92428571]
 [0.90142857 0.90142857]
 [0.87285714 0.87285714]
 [0.75       0.75      ]]
DEBUG::False positive rate w.r.t p_threshold array:
[[0.25       0.25      ]
 [0.12714286 0.12714286]
 [0.09857143 0.09857143]
 [0.07571429 0.07571429]
 [0.065      0.065     ]
 [0.05357143 0.05357143]
 [0.04928571 0.04928571]
 [0.045      0.045     ]
 [0.04285714 0.04285714]
 [0.03928571 0.03928571]
 [0.03785714 0.03785714]
 [0.03428571 0.03428571]
 [0.02714286 0.02714286]
 [0.02428571 0.02428571]
 [0.02214286 0.02214286]
 [0.01857143 0.01857143]
 [0.01357143 0.01357143]
 [0.01285714 0.01285714]
 [0.00857143 0.00857143]
 [0.00642857 0.00642857]]
Time for hyperparameter (per-class threshold) is 629.839806 sec

real	1601m20.907s
user	6936m22.081s
sys	533m35.372s

